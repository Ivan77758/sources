"use strict";var _Vue$component,_get=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(n):void 0},_createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var json={parse:function(t){var e=null;try{e=JSON.parse(t)}catch(t){}return e},encode:function(t){return JSON.stringify(t)}},cookie_storage={enabled:0,init:function(){},get_cookie:function(t){var e=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return e?unescape(e[2]):null},del_cookie:function(t){var e=new Date;e.setTime(e.getTime()-1e3),document.cookie=t+"=; expires="+e.toGMTString()+"; path=/"},set_cookie:function(t,e,i){var n=new Date;n.setTime(n.getTime()+6e4*i),document.cookie=t+"="+e+"; expires="+n.toGMTString()+"; path=/"},get_data:function(t){return json.parse(get_cookie(t))},set_data:function(){}};function get_cookie(t){var e=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return e?unescape(e[2]):null}function del_cookie(t){var e=new Date;e.setTime(e.getTime()-1e3),document.cookie=t+"=; expires="+e.toGMTString()+"; path=/"}function set_cookie(t,e,i){var n=new Date;n.setTime(n.getTime()+6e4*i),document.cookie=t+"="+e+"; expires="+n.toGMTString()+"; path=/"}var device={init:function(){},width:function(){return $(window).width()},height:function(){return $(window).height()}};function disabled_with_timeout(t,e){t.prop("disabled",!0),setTimeout(function(){t.prop("disabled",!1)},1e3*e)}function getTimestamp(){return(new Date).getTime()}function simple_hash(){hash=getTimestamp()}function disabled_with_timeout(t,e){t.prop("disabled",!0),setTimeout(function(){t.prop("disabled",!1)},1e3*e)}(storage={enable:0,init:function(){storage.is_enable()&&(storage.enable=1)},is_enable:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},save:function(t,e){storage.enable&&localStorage.setItem(t,e)},load:function(t,e){var i=e||null;return storage.enable&&localStorage.getItem(t)&&(i=localStorage.getItem(t)),i},array:{load:function(t){var e=[],i=null;return i=storage.load(t),(i=json.parse(i))&&(e=i),e},save:function(t,e){storage.save(t,json.encode(e))},add:function(t,e){}}}).init(),Vue.component("abuse-dialog",{template:"#abuse-dialog",props:["humanId"],data:function(){return{items:[{title:"Предложение оплаты услуг",text:"вирт за деньги, проституция"},{title:"Развод на деньги",text:"мошенничество, шантаж, вымогательство"},{title:"Фото из интернета",text:"вымышленные данные, обман, фейк"},{title:"Оскорбления, хамство",text:"троллинг, грубые сообщения"},{title:"Рассылает интим фото",text:"спамит или провоцирует"}],selected:null,comment:"",process:!1}},methods:{select:function(t){this.selected=t},send:function(){var e=this,t=getTimestamp(),i=this.selected.title+", "+this.selected.text;i=this.comment?i+" ["+this.comment+"]":i;var n={id:this.humanId,captcha:"",text:i,hash:t};this.process=!0,api.raw.save(n,null,"abuse/send").then(function(t){t.data.error?e.$emit("needed"):e.$emit("success"),e.process=!1,e.$emit("close")})}}}),Vue.component("claim-needed",{template:"#claim-needed"}),Vue.component("cliche-dialog",{template:"#cliche-dialog"});var AccountActivity=Vue.component("account-activity",{props:["humanId"],data:function(){return{loading:!1}},computed:{human:function(){return this.$store.state.search.human}},mounted:function(){this.load()},methods:{close:function(){this.$emit("close")},loaded:function(){this.loading=!1,console.log(this.human)},hope:function(){var t=this;setTimeout(function(){return t.loading=!1},4e3)},load:function(){var e=this;this.loading=!0,this.hope(),store.dispatch("search/HUMAN",this.humanId).then(function(t){e.loaded()}).catch(function(t){console.log(t),e.loading=!1})}},template:"#account-activity"});Vue.component("account-component",{props:["human"],data:function(){return{loading:!1}},computed:{age:function(){return this.human.age?moment.duration(this.human.age,"years").humanize():null},tags:function(){return"tags"in this.human?this.human.tags:[]},social:function(){var t=this.human,e=t.em,i=t.vk,n=t.ok,s=t.fb,o=t.go;return e||i||n||s||o?{em:e,vk:i,ok:n,fb:s,go:o}:null},interact:function(){var t=this.human,e=t.ph,i=t.sk;return e||i?{ph:e,sk:i}:null},figure:function(){var t=this.human.anketa?this.human.anketa.figure:null,e=t;switch(t){case 2:e="спортивного";break;case 3:e="обычного";break;case 5:e="полного";break;case 6:e="худого"}return e},hold:function(){return this.ignore?0:this.human.hold},who:function(){var t="Парня ";return this.human.sex&&(t=2==this.human.sex?"Парня ":"Девушку "),this.human.who&&(t=1==this.human.who?"Парня ":"Девушку "),(this.human.up||this.human.to)&&(t+=" в возрасте ",t+=this.human.up?" от "+this.human.up:"",t+=this.human.to?" до "+this.human.to:"",t+=" лет "),t},ago:function(){var t=this.human.last,e="Онлайн";return 2592e3<t&&(e=null),777<t&&(e=moment.duration(0-t,"seconds").humanize(!0)),e},search:function(){return city=this.human.city?this.human.city+"/":"",1==this.human.who?who="Парни/":2==this.human.who?who="Девушки/":who="",this.human.up&&this.human.up==this.human.to?years="возраст/"+this.human.up+"/":this.human.up&&this.human.to?years="возраст/"+this.human.up+"/"+this.human.to+"/":this.human.up&&!this.human.to?years="возраст/от/"+this.human.up+"/":!this.human.up&&this.human.to?years="возраст/до/"+this.human.to+"/":years="","/"+city+who+years}},template:"#account-component"});var ActivityActions={beforeRouteLeave:function(t,e,i){console.log("Leave:",[t,e]),i()},data:function(){return{toSlow:!1,slowTime:3,process:!1,labels:{load:!1,error:!1},timerLoader:null,timerProcess:null}},methods:{close:function(){this.$emit("close")},back:function(t){t=void 0===(t=void 0===t?this.$route.meta.back:t)?this.$route.query.back:t,console.log("back:",t),void 0===t?this.$router.push("/"):this.$router.push(t)},loadStart:function(t){var e=this;this.labels.load=!0,t=t||this.slowTime,this.timerLoader=setTimeout(function(){e.toSlow=!0},1e3*t)},loadStop:function(){this.labels.load=!1,clearTimeout(this.timerLoader),this.toSlow=!1},errorStart:function(){this.labels.error=!0},errorStop:function(){this.labels.error=!1},processTimeout:function(t){var e=this;this.process=!0,clearTimeout(this.timerProcess),t=t||this.slowTime,this.timerProcess=setTimeout(function(){return e.process=!1},1e3*t)}}},ClosedActivity=Vue.component("closed-activity",{extends:ActivityActions,template:"#closed-activity"}),DefaultActivity=Vue.component("default-activity",{extends:ActivityActions,template:"#default-activity"});Vue.component("list-date",{props:["list","index"],computed:{count:function(){return this.list.length},item:function(){return this.list[this.index]},currDate:function(){return moment(this.item.date).date()},prevDate:function(){if(this.index&&this.index<this.count)return moment(this.list[this.index-1].date).date()},month:function(){return moment(this.item.date).format("MMMM").substring(0,3)},formatted:function(){var t=this.currDate+" "+this.month,e=moment().date(),i=moment().subtract(1,"day").date();return t=this.currDate===e?"Сегодня":t,t=this.currDate===i?"Вчера":t},date:function(){return this.prevDate!=this.currDate?this.formatted:null}},template:"#list-date"});var prev=null;Vue.component("message-item",{props:["item","index","count","alert"],template:"#messages-item",data:function(){return{showOption:!1,fixOption:!1,alertOption:!1,showDialog:!1,photo:!1,photoNotFound:!1}},methods:{fix:function(){this.showOption=!0,this.alertOption=!1,this.alert?this.$emit("admit"):this.fixOption=!this.alert&&!this.fixOption},bun:function(){var e=this,t={headers:{Authorization:"Bearer "+this.$store.state.apiToken}},i={id:this.item.id,tid:this.item.from};axios.post("/mess/bun/",i,t).then(function(t){e.$emit("remove",e.index)}).catch(function(t){console.log("error")})},cancel:function(){this.showDialog=!1,console.log("cancel")},remove:function(){var t={headers:{Authorization:"Bearer "+this.$store.state.apiToken}},e={id:this.item.id};axios.post("/mess/delete/",e,t).then(function(t){}).catch(function(t){console.log(t)}),this.$emit("remove",this.index)},play:function(){var e=this,t={headers:{Authorization:"Bearer "+this.$store.state.apiToken},params:{tid:this.item.from}},i="http://"+this.$store.state.photoServer+"/api/v1/users/"+this.uid+"/sends/"+this.alias+".jpg";axios.get(i,t).then(function(t){e.preview(t.data.photo)}).catch(function(t){console.log(t),t.response&&"404"==t.response.status&&(e.photoNotFound=!0)})},preview:function(t){var e=t._links;e.origin.href&&(this.photo={thumb:e.thumb.href,photo:e.origin.href,alias:t.alias,height:t.height,width:t.width})},pathName:function(t){return!t||t.length<10?null:[t.substr(0,2),t.substr(2,2),t.substr(4,3)].join("/")+"/"+t}},mounted:function(){!this.sent&&!this.index&&this.count<5&&(this.fix(),this.alertOption=!0),this.sent||this.read||this.$emit("set-new")},updated:function(){},computed:{uid:function(){return this.$store.state.user.uid},attention:function(){return this.alert||this.alertOption?1:0},option:function(){return!(this.index||!this.alert)||(this.showOption||this.fixOption?1:0)},sent:function(){return this.uid&&this.uid!=this.item.from?0:1},read:function(){return 0!=this.item.read},time:function(){return moment(this.item.date).format("HH:mm")},alias:function(){var t=!1,e=this.item.mess,i=/.+images.intim?.(.{32})\.(jpg)/i,n=/\[\[IMG:(.{32})\]\]/i;return(t=!(t=!!i.test(e)&&i.exec(e))&&n.test(e)?n.exec(e):t)&&(t=t[1]),t},image:function(){var t=this.$store.state.photoServer,e=this.pathName(this.alias);return!!e&&"http://"+t+"/res/photo/preview/"+e+".png"},previous:function(){var t=prev;return prev=this.item.from,!t||t==prev}}}),Vue.component("message-list",{props:["humanId"],data:function(){return{messages:[],response:null,error:0,next:0,newCount:0,batch:15,received:0,attention:!1,date:null,toSlow:!1,skipScroll:!1,dialog:{abuse:!1,claim:!1},abuseSuccessHint:!1}},mounted:function(){this.load()},methods:{reload:function(){this.next=0,this.newCount=0,this.messages=[],this.load(),fdate=null,prev=null},load:function(){var e=this;this.response=0;var t={headers:{Authorization:"Bearer "+this.$store.state.apiToken},params:{id:this.humanId,next:this.next,hash:hash}};axios.get("/ajax/messages_load.php",t).then(function(t){e.onLoad(t)}).catch(function(t){e.error=10,console.log(t)}),setTimeout(function(){return e.toSlow=!0},7e3)},loadNext:function(){this.skipScroll=!0,this.load()},onLoad:function(t){var e=t.data.messages;this.received=e?e.length:0,e||this.messages.length?(this.received&&(this.messages=_.union(e.reverse(),this.messages)),this.next+=this.batch,this.scammer()):this.noMessages(),this.response=200,this.toSlow=!1,this.$nextTick(function(){})},scroll:function(){if(this.skipScroll)return this.skipScroll=!1;var t=document.getElementById("dialog-history");console.log("scroll",t.scrollTop),t.scrollTop=t.scrollHeight+30,console.log("scroll",t.scrollTop)},noMessages:function(){},scammer:function(){this.$emit("attention",this.replyCount)},setDate:function(t){},remove:function(t){this.messages.splice(t,1)},admit:function(){this.attention=!1},setNew:function(){this.newCount+=1}},computed:{count:function(){return this.messages.length},replyCount:function(){return _.where(this.messages,{from:this.userId+""}).length},more:function(){return!(!this.received||this.received!=this.batch)},userId:function(){return this.$store.state.user.uid}},template:"#message-list"});var MessagesActivity=Vue.component("messages-activity",{extends:DefaultActivity,props:["humanId","title"],data:function(){return{message:"",caption:"",reply:"",code:"",show:!0,process:!1,approve:!0,dirt:!1,alert:!1,captcha:!1,virification:!1,preview:!1,photo:!1,photoIsRemoved:!1}},mounted:function(){this.title&&(this.caption=this.title)},methods:{reset:function(){this.show=!0,this.process=!1,this.approve=!0,this.message="",this.photo=null},isDirt:_.debounce(function(){return this.dirt=!!/\w{0,5}[хx]([хx\s\!@#\$%\^&*+-\|\/]{0,6})[уy]([уy\s\!@#\$%\^&*+-\|\/]{0,6})[ёiлeеюийя]\w{0,7}|\w{0,6}[пp]([пp\s\!@#\$%\^&*+-\|\/]{0,6})[iие]([iие\s\!@#\$%\^&*+-\|\/]{0,6})[3зс]([3зс\s\!@#\$%\^&*+-\|\/]{0,6})[дd]\w{0,10}|[сcs][уy]([уy\!@#\$%\^&*+-\|\/]{0,6})[4чkк]\w{1,3}|\w{0,4}[bб]([bб\s\!@#\$%\^&*+-\|\/]{0,6})[lл]([lл\s\!@#\$%\^&*+-\|\/]{0,6})[yя]\w{0,10}|\w{0,8}[её][bб][лске@eыиаa][наи@йвл]\w{0,8}|\w{0,4}[еe]([еe\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[uу]([uу\s\!@#\$%\^&*+-\|\/]{0,6})[н4ч]\w{0,4}|\w{0,4}[еeё]([еeё\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[нn]([нn\s\!@#\$%\^&*+-\|\/]{0,6})[уy]\w{0,4}|\w{0,4}[еe]([еe\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[оoаa@]([оoаa@\s\!@#\$%\^&*+-\|\/]{0,6})[тnнt]\w{0,4}|\w{0,10}[ё]([ё\!@#\$%\^&*+-\|\/]{0,6})[б]\w{0,6}|\w{0,4}[pп]([pп\s\!@#\$%\^&*+-\|\/]{0,6})[иeеi]([иeеi\s\!@#\$%\^&*+-\|\/]{0,6})[дd]([дd\s\!@#\$%\^&*+-\|\/]{0,6})[oоаa@еeиi]([oоаa@еeиi\s\!@#\$%\^&*+-\|\/]{0,6})[рr]\w{0,12}/i.test(this.message),this.dirt},700),attention:function(t){this.alert=t<3},close:function(){this.back()},cancel:function(){this.captcha=!1,this.confirm=!1,this.ignore=!0,console.log("cancel")},select:function(t){this.photo=t,this.preview=t},sendMessage:function(t){var i=this;this.$store.commit("grecaptchaTokenUpdate",t);var e={id:this.humanId,captcha_code:this.code,token:this.$store.state.grecaptchaToken};this.photo&&this.photo.alias?e.photo=this.photo.alias:(e.mess=this.message,e.re=this.reply),this.$store.commit("intimate/notifi",!1),api.messages.send(e).then(function(t){var e=t.data;i.onMessageSend(e)}).catch(function(){i.onError()}),this.preview=null,this.process=!0},setCode:function(t){this.code=t,this.sendMessage()},onMessageSend:function(t){t.saved;var e=t.error;e?("need_captcha"==e&&(this.captcha=!0),"need_verify"==e&&(this.virification=!0,this.$refs.recaptcha.render(this.sendMessage),this.$refs.recaptcha.execute()),this.onError()):this.sended(),this.process=!1},sended:function(){this.$refs.messages.reload(),this.reset(),this.$refs.recaptcha.reset()},onError:function(){this.process=!1},account:function(){this.$router.push(this.humanId+"/detail")},uploads:function(){this.$router.push(this.humanId+"/uploads")},incoming:function(){this.$router.push(this.humanId+"/incoming")},videochat:function(){window.open("/videochat.php?to="+this.humanId,"videochat","width=432, height=280, resizable=yes, scrollbars=yes")}},template:"#messages-activity"}),ModeratorActivity=Vue.component("moderator-activity",{data:function(){return{process:!1,promt:!0,error:null,count:null,message:{id:null,text:""},secure:null,expire:null}},mounted:function(){this.load()},computed:{human:function(){return this.$store.state.search.human},accept:function(){return this.$store.state.accepts.moderator}},methods:{approve:function(){var t=this;this.process=!0,api.moderator.promt().then(function(){t.load()}).catch(function(){t.needPromt(),t.process=!1}),this.$store.commit("accepts/moderator",1)},load:function(){var i=this;this.process=!0,api.moderator.load().then(function(t){var e=t.data;i.error=e.error,"promt"==i.error?i.needPromt():"count"==i.error||"other"==i.error||!i.error&&e.message&&i.loaded(e),i.process=!1})},loaded:function(t){var e=t.count,i=t.message,n=t.expire,s=t.secure;this.count=e,this.message=i,this.expire=n,this.secure=s},needPromt:function(){this.$store.commit("accepts/moderator",0),this.promt=!1},action:function(t){var e=this,i={id:this.message.id,secure:this.secure,expire:this.expire,mark:t};this.process=!0,api.moderator.press(i).then(function(){e.load()})},close:function(){this.$emit("close")}},template:"#moderator-activity"}),QuestionActivity=Vue.component("question-activity",{extends:ClosedActivity,props:[],data:function(){return{queries:[],text:"",needResponse:!0,sended:!1,showForm:!1,isEmpty:!1}},mounted:function(){this.load(),this.flash()},methods:{load:function(){var i=this;this.loadStart(3),axios.get("/static/json/faq/list.ru.json?v=3").then(function(t){var e=t.data;i.queries=e,i.loadStop()})},flash:function(){var t=ls.get("review-text");this.text=t||""},show:function(t){var e=this.queries[t].show;this.queries[t].show=!1===e},expand:function(){var t=this;this.showForm=!0,this.$nextTick(function(){t.$refs.text.focus()})},handle:function(){this.text?this.send():this.isEmpty=!0},send:function(){var e=this;api.raw.post({text:this.text,hash:hash},null,"security/askme").then(function(t){t.data;e.process=!1,e.text="",ls.remove("review-text")}),this.isEmpty=!1,this.process=!0,this.sended=!0},noReviews:function(){this.needResponse=!0},switchToReviews:function(){ls.set("review-text",this.text,5),this.$router.push("reviews")}},template:"#question-activity"}),SearchActivity=Vue.component("search-activity",{extends:DefaultActivity,data:function(){return{}},beforeRouteUpdate:function(t,e,i){"/search"==t.fullPath&&"/search/settings/search"==e.fullPath&&this.$refs.results.reload(),i()},computed:{},methods:{close:function(){this.back()}},template:"#search-activity"});Vue.component("city-suggest",{props:["city"],data:function(){return{query:"",cities:[],enable:!0}},mounted:function(){!this.query&&this.city&&2<this.city.length&&(this.query=this.city)},computed:{suggested:function(){return this.cities.length}},methods:{load:function(){var e=this;if(!this.query.length)return this.reset();api.user.get({q:this.query,hash:hash},"town/suggest").then(function(t){e.loaded(t.data.cities)})},reset:function(){this.cities=[]},select:function(t){this.query=t,this.$emit("select",t),this.reset()},loaded:function(t){t&&t.length?this.cities=t:this.reset()}},template:"#city-suggest"});var ContactDialog={extends:DefaultActivity,props:["quick"],data:function(){return{response:!1,slow:!1,error:!1,amount:0,offset:0,batch:10,max:100,dialog:!1,modals:{acceptSettings:!1}}},computed:{showLoader:function(){return this.slow&&!this.response},showAlert:function(){return this.error&&this.response},showHint:function(){return this.count<1},count:function(){return this.contacts?this.contacts.length:0},more:function(){var t=this.offset<=this.max-this.batch;return this.amount>=this.batch&&t}},methods:{close:function(){this.back()},reset:function(){this.response=!1,this.error=!1,this.slow=!1},hope:function(){var t=this;setTimeout(function(){return t.slow=!0},2e3),this.reset()},loaded:function(t){this.offset+=this.batch,this.amount=this.count,this.response=!0,this.slow=!1},bun:function(t){var e=this.contacts[t];console.log("bun",e),this.remove(t),api.bun.send({id:e.message.mess_id,tid:e.human_id})},splice:function(t){this.$store.commit("delete",t)},error:function(t){this.response=!0,this.error=!0,console.log(t)},dialogOpen:function(t){this.dialog=t.id,this.title=t.title}},mounted:function(){this.load()}},InitialDialog=Vue.component("initial-dialog",{extends:ContactDialog,mounted:function(){this.$store.dispatch("initial/CHECK")},computed:{initial:function(){return!0},simple:function(){return!0},contacts:function(){return this.$store.state.contacts.initial.list}},methods:{load:function(){var e=this;this.$store.dispatch("initial/LOAD").then(function(t){e.loaded()}),this.amount=this.count,this.hope()},next:function(){var e=this;this.$store.dispatch("initial/NEXT",this.offset).then(function(t){e.loaded()}),this.reset()},remove:function(t){this.$store.dispatch("initial/DELETE",t)},read:function(t){console.log("initial=read",t),this.$store.dispatch("initial/READ",t)},splice:function(t){this.$store.commit("initial/delete",t)},idle:function(t){var e=!1;if(t.user){var i=t.user,n=i.sex,s=i.city,o=i.age,a=this.$store.state.user,r=a.sex,c=a.city,u=a.up,h=a.to,l=a.any;r==n&&(e=!0),c==s||l||(e=!0),u&&o<u&&(e=!0),h&&h<o&&(e=!0)}return e},accept:function(){this.$store.commit("accepts/settings")}},template:"#initial-dialog"}),IntimateDialog=Vue.component("intimate-dialog",{extends:ContactDialog,data:function(){return{max:100}},mounted:function(){this.$store.dispatch("intimate/CHECK")},computed:{initial:function(){return!0},simple:function(){return!1},contacts:function(){return this.$store.state.contacts.intimate.list}},methods:{load:function(){var e=this;this.$store.dispatch("intimate/LOAD",this.next).then(function(t){e.loaded()}).catch(function(t){return e.error=t}),this.amount=this.count,this.hope()},next:function(){var e=this;this.$store.dispatch("intimate/NEXT",this.offset).then(function(t){e.loaded()}),this.hope()},remove:function(t){console.log("imm=remove",t),this.$store.dispatch("intimate/DELETE",t)},read:function(t){console.log("intimate=read",t),this.$store.dispatch("intimate/READ",t)},splice:function(t){this.$store.commit("intimate/delete",t)}},template:"#intimate-dialog"}),SendsDialog=Vue.component("sends-dialog",{extends:ContactDialog,computed:{initial:function(){return!1},simple:function(){return!1},contacts:function(){return this.$store.state.contacts.sends.list}},methods:{load:function(){var e=this;this.$store.dispatch("sends/LOAD",this.next).then(function(t){e.loaded()}),this.amount=this.count,this.hope()},next:function(){var e=this;this.$store.dispatch("sends/NEXT",this.offset).then(function(t){e.loaded()}),this.reset()},remove:function(t){this.$store.dispatch("sends/DELETE",t)},splice:function(t){this.$store.commit("sends/delete",t)}},template:"#initial-dialog"});Vue.component("contact-item",{props:["item","index","idle","quick"],data:function(){return{account:!1,detail:!1,confirm:!1}},computed:{name:function(){var t="Парень или девушка";return this.item.user&&(t=2==this.item.user.sex?"Девушка":"Парень",this.item.user.name&&(t=this.item.user.name)),t},age:function(){return this.item.user&&this.item.user.age?this.item.user.age:""},city:function(){return this.item.user&&this.item.user.city?this.item.user.city:""},title:function(){return this.name+" "+this.age+" "+this.city},message:function(){return this.item.message?this.item.message.text:""},unread:function(){return this.item.message?this.item.message.unread:0},sent:function(){return this.item.message?this.item.message.sender==this.$store.state.user.uid:0},humanId:function(){return this.item.human_id},acceptSettings:function(){return this.$store.state.accepts.settings}},methods:{show:function(){this.idle&&!this.acceptSettings?this.$emit("accept"):this.quick?this.reply():this.dialog()},reply:function(){this.$emit("read",this.index),this.$router.push({name:"quickReply",params:{humanId:this.humanId,message:this.message,index:this.index}})},dialog:function(){this.$emit("read",this.index),this.$router.push({name:"dialog",params:{humanId:this.humanId,title:this.title}})},confirmBun:function(){this.confirm="doit",console.log("confirmBun")},confirmRemove:function(){this.confirm=this.quick?"must":"some"},close:function(){this.detail=!1,console.log("close")},bun:function(){console.log("bun1",this.index),this.$emit("bun",this.index)},remove:function(){console.log("remove=remove",this.index),this.$emit("remove",this.index)},cancel:function(){this.confirm=!1,console.log("cancel")},sended:function(){this.$emit("sended",this.index),this.close()}},template:"#contact-item"}),Vue.component("settings-inform",{template:"#settings-inform",methods:{confirm:function(){this.$emit("confirm"),this.$emit("close")}}});var ContentActivity=Vue.component("content-activity",{extends:ActivityActions,props:["link","locale"],data:function(){return{title:"",text:"",file:"",more:null,edit:null,loader:!0,error:!1,galery:[],preview:null,enableReview:!1,reviews:[],batch:7}},computed:{ready:function(){return!this.loader&&!this.error}},methods:{load:function(t){var i=this;axios.get(t).then(function(t){var e=t.data;i.loaded(e)}).catch(function(t){i.failed(t)})},loaded:function(t){this.loader=!1,t.content?(this.text=t.content,this.file=t.file,this.more=t.more||null,this.edit=t.edit||null,this.galery=t.galery||[]):this.failed()},failed:function(){this.error=!0},show:function(t){this.preview=this.galery[t]}},template:"#content-activity"}),ContentModal=Vue.component("content-modal",{extends:ActivityActions,props:["link"],data:function(){return{text:"Загружаю..."}},mounted:function(){var i=this;axios.get("/static/htm/promo/"+this.link+".htm").then(function(t){var e=t.data;i.text=e})},template:"#content-modal"}),СareersContentPage=Vue.component("careers-page",{extends:ContentActivity,mounted:function(){this.title="Работа и вакансии",this.load("/content/careers/ru")}}),DealContentPage=Vue.component("deal-page",{extends:ContentActivity,mounted:function(){this.title="Информация",this.load("/content/deal/"+this.link)}}),HelpContentPage=Vue.component("help-page",{extends:ContentActivity,data:function(){return{enableReview:!0}},mounted:function(){this.title="Справка",this.load("/content/help/"+this.link),this.loadReviews()},methods:{show:function(t){this.preview=this.galery[t]},loadReviews:function(){var i=this;axios.get("/docs/blog/rev/"+this.link+".json").then(function(t){var e=t.data;i.reviews=e})}}}),ReleaseContentPage=Vue.component("release-page",{extends:ContentActivity,mounted:function(){this.title="Что нового",this.load("/content/releases/"+this.link)}}),RulesContentPage=Vue.component("rules-page",{extends:ContentActivity,mounted:function(){this.title="Правила сообщества",this.load("/content/rules/ru")}});Vue.component("desire-tag-item",{props:["id","tag","added"],data:function(){return{active:!1,error:!1}},methods:{activate:function(){var t=this;this.active=!0,_.delay(function(){return t.active=!1},3e3)},select:function(){this.activate(),this.$emit("select",this.tag)}},template:"#desire-tag-item"}),Vue.component("desire-list",{props:["tags"],computed:{desires:function(){return this.$store.getters["desires/tags"]}},methods:{add:function(t){this.added(t)||this.$store.dispatch("desires/ADD",t).then(function(t){})},added:function(t){return _.contains(this.desires,t)}},template:"#desire-list"});var ModalDialog=Vue.component("modal-dialog",{extends:ActivityActions,methods:{onEsc:function(t){27===t.keyCode&&this.close()}},mounted:function(){document.addEventListener("keydown",this.onEsc)},beforeDestroy:function(){document.removeEventListener("keydown",this.onEsc)},template:"#modal-dialog"});Vue.component("attention-wall",{props:["show"],data:function(){return{content:{1:{caption:"Предупреждение",text:"На сообщения от этого пользователя поступают жалобы. Возможно его сообщения имеют грубый тон,\n                    могут оскорбить, содержат интим фотографии, бессмысленные или резкие предложения."},8:{caption:"Внимание",text:"Действия пользователя нарушают правила. Сообщения пользователя намеренно оскорбительны,\n                    имеют противоправное содержание, обман или предложение оплаты услуг."}}}},computed:{caption:function(){return this.content[this.show].caption},text:function(){return this.content[this.show].text}},methods:{close:function(){this.$emit("close")},promt:function(){this.$emit("promt")}},template:"#attention-wall"}),Vue.component("captcha-dialog",{data:function(){return{code:"",inc:0}},computed:{src:function(){return simple_hash(),"/secret_pic.php?inc="+this.inc+"&hash="+hash}},methods:{close:function(){this.$emit("cancel")},send:function(){this.$emit("send",this.code),this.update(),this.close()},update:function(){this.inc++}},template:"#captcha-dialog"}),Vue.component("email-sended",{template:"#email-sended"}),Vue.component("info-dialog",{props:["text"],extends:ModalDialog,template:"#info-dialog"}),Vue.component("inform-dialog",{props:["loader","alert","hint"],computed:{hasContext:function(){return!!this.$slots.context},hasHint:function(){return!!this.$slots.hint}},methods:{close:function(){this.$emit("close")}},template:"#inform-dialog"}),Vue.component("loading-cover",{props:["show","text"],computed:{loader:function(){return this.text?this.text:"Отправляю"}},template:"#loading-cover"}),Vue.component("loading-wall",{props:["show","text"],data:function(){return{hope:!1}},computed:{loader:function(){return this.text?this.text:"Загружаем"}},mounted:function(){var t=this;this.hope=!1,setTimeout(function(){return t.hope=!0},3e3)},template:"#loading-wall"}),Vue.component("option-dialog",{template:"#option-static__dialog-window",methods:{close:function(){this.$emit("close")}},created:function(){var t=this;document.addEventListener("keydown",function(){t.show&&27===event.keyCode&&t.close()})},updated:function(){this.show&&$("html, body").animate({scrollTop:0},"slow")}}),Vue.directive("resized",{bind:function(e){$(e).on("change",function(){e.style.height="1px";var t=40<e.scrollHeight?3:0;e.style.height=e.scrollHeight+t+"px"})},componentUpdated:function(t){$(t).change()}});var QuickDialog={extends:ModalDialog,props:["humanId","message","index"],data:function(){return{text:"",captcha:!1,loading:!1,confirm:!1,ignore:!1,addition:!1,code:null,modals:{cliche:!1,notepad:!1},interests:{show:!1,ignore:!1},dirt:{show:!1,ignore:!1},spam:{show:!1,ignore:!1}}},mounted:function(){this.reload(),console.log("reply",this.reply)},computed:{caption:function(){return this.reply?"Быстрый ответ":"Написать сообщение"},human:function(){return this.$store.state.search.human},user:function(){return this.$store.state.user},tags:function(){return"tags"in this.human?this.human.tags:[]},hold:function(){return this.ignore?0:this.human.hold},added:function(){return!(this.user.city&&this.user.age&&this.user.name)}},methods:{reload:function(){var e=this;this.loading=!0,setTimeout(function(){return e.loading=!1},4e3),store.dispatch("search/HUMAN",this.humanId).then(function(t){e.loaded()}).catch(function(t){e.loading=!1})},isDirt:function(){return!!/\w{0,5}[хx]([хx\s\!@#\$%\^&*+-\|\/]{0,6})[уy]([уy\s\!@#\$%\^&*+-\|\/]{0,6})[ёiлeеюийя]\w{0,7}|\w{0,6}[пp]([пp\s\!@#\$%\^&*+-\|\/]{0,6})[iие]([iие\s\!@#\$%\^&*+-\|\/]{0,6})[3зс]([3зс\s\!@#\$%\^&*+-\|\/]{0,6})[дd]\w{0,10}|[сcs][уy]([уy\!@#\$%\^&*+-\|\/]{0,6})[4чkк]\w{1,3}|\w{0,4}[bб]([bб\s\!@#\$%\^&*+-\|\/]{0,6})[lл]([lл\s\!@#\$%\^&*+-\|\/]{0,6})[yя]\w{0,10}|\w{0,8}[её][bб][лске@eыиаa][наи@йвл]\w{0,8}|\w{0,4}[еe]([еe\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[uу]([uу\s\!@#\$%\^&*+-\|\/]{0,6})[н4ч]\w{0,4}|\w{0,4}[еeё]([еeё\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[нn]([нn\s\!@#\$%\^&*+-\|\/]{0,6})[уy]\w{0,4}|\w{0,4}[еe]([еe\s\!@#\$%\^&*+-\|\/]{0,6})[бb]([бb\s\!@#\$%\^&*+-\|\/]{0,6})[оoаa@]([оoаa@\s\!@#\$%\^&*+-\|\/]{0,6})[тnнt]\w{0,4}|\w{0,10}[ё]([ё\!@#\$%\^&*+-\|\/]{0,6})[б]\w{0,6}|\w{0,4}[pп]([pп\s\!@#\$%\^&*+-\|\/]{0,6})[иeеi]([иeеi\s\!@#\$%\^&*+-\|\/]{0,6})[дd]([дd\s\!@#\$%\^&*+-\|\/]{0,6})[oоаa@еeиi]([oоаa@еeиi\s\!@#\$%\^&*+-\|\/]{0,6})[рr]\w{0,12}/i.test(this.text)},isPhone:function(){return!!/\d.*\d.*\d.*\d.*\d.*\d.*\d.*/i.test(this.text)},isLink:function(){return!!/(https?:\/\/(www\.)?)/i.test(this.text)},isSpam:function(){return this.isPhone()||this.isLink()},proxy:function(){this.added?this.addition=!0:this.isDirt()&&!this.dirt.ignore?this.dirt.show=!0:this.isSpam()&&!this.spam.ignore?this.spam.show=!0:this.send()},loaded:function(){this.loading=!1,this.visited()},remove:function(){console.log("::remove:: (!)"),this.$emit("remove")},cancel:function(){this.captcha=!1,this.confirm=!1,this.ignore=!0,console.log("cancel")},send:function(t){var i=this;this.$store.commit("grecaptchaTokenUpdate",t);var e={id:this.humanId,mess:this.text,captcha_code:this.code,token:this.$store.state.grecaptchaToken};api.messages.send(e).then(function(t){var e=t.data;i.onMessageSend(e)}).catch(function(t){i.onError(t)}),this.processTimeout(5)},setCode:function(t){this.code=t,this.send()},onMessageSend:function(t){var e=t.saved,i=t.error;!e&&i?("need_captcha"==i&&(this.captcha=!0),"need_verify"==i&&(this.processTimeout(5),this.$refs.recaptcha.render(this.send),this.$refs.recaptcha.execute())):(this.$store.dispatch("notes/UPDATE",this.text),this.sended())},sended:function(){this.process=!1,this.$emit("sended"),this.close(),this.$refs.recaptcha.reset()},account:function(){this.$router.push(this.humanId+"/detail")},onError:function(){this.process=!1},visited:function(){this.$store.dispatch("visited/ADD",this.humanId)},close:function(){this.back()},setText:function(t){this.text=t}},template:"#quick-message"},QuickMessage=Vue.component("quick-message",{extends:QuickDialog,computed:{reply:function(){return!1},information:function(){var t="",e={2:"парни",1:"девушки"};if(this.human.sex&&this.human.sex==this.user.sex)t="Мне интересны только "+e[this.human.sex];else if(this.human.sex){var i=this.user.age;this.human.up&&i&&this.human.up>i&&(t="Мне интересны "+e[this.human.sex]+" в возрасте от "+this.human.up+" лет "),this.human.to&&i&&this.human.to<i&&(t="Мне интересны "+e[this.human.sex]+" в возрасте до "+this.human.to+" лет ")}return!this.human.up&&!this.human.to||this.user.age||(t="Укажите ваш возраст в анкете, для меня это важно"),this.human.close&&this.user.city&&this.user.city!=this.human.city&&(t="Мне интересно общение только в моём городе"),this.human.close&&!this.user.city&&(t="Укажите ваш город в анкете, для меня это важно"),t}},methods:{action:function(){this.user.city?this.user.age||this.$router.push("settings/account"):this.$router.push("wizard/city")},proxy:function(){this.added?this.addition=!0:this.information&&!this.interests.ignore?this.interests.show=!0:this.isDirt()&&!this.dirt.ignore?this.dirt.show=!0:this.isSpam()&&!this.spam.ignore?this.spam.show=!0:this.send()}}}),QuickReply=Vue.component("quick-reply",{extends:QuickDialog,computed:{reply:function(){return!0},information:function(){return this.message}},methods:{sended:function(){this.$emit("sended",this.index),this.close()},action:function(){}}});Vue.component("remind-login",{data:function(){return{email:"",hint:"Введите ваш емайл",confirm:!1}},computed:{},methods:{close:function(){this.$emit("close")},send:function(){var e=this;this.email&&(this.hint="Отправляю...",api.user.post({email:this.email},null,"sync/remind").then(function(t){e.hint=t.data.say,e.error=t.data.err,e.sended()}))},sended:function(){this.error||(this.hint="Успешно. Подождите.",this.confirm=!0)}},template:"#remind-login"});var RemoveConfirm=Vue.component("remove-confirm",{props:["show","item"],data:function(){return{content:{doit:{caption:"Наказывайте как следует",text:"За резкие слова, за оскорбления или хамство,\n                    за фотографии не в тему или бессмысленные сообщения, наказывайте всех, кого\n                    считаете нужным. Наказание действует сразу.",action:"Удалить и наказать"},must:{caption:"Может стоит наказать?",text:'Нажмите "Дизлайк" у сообщения или контакта, которое вызвало негативные эмоции.\n                    Наказание действует сразу же. Мы никогда не узнаем о нарушениях, если удалить без наказания.',action:"Удалить и забыть"},some:{caption:"Удалить навсегда",text:"Ваше сообщение будет удалено отовсюду, без возможности восстановить. Сообщение\n                    пропадет как из вашей истории переписки, так и из переписки вашего собеседника.",action:"Удалить навсегда"}}}},computed:{variant:function(){return this.show?this.show:"some"},caption:function(){return this.content[this.variant].caption},text:function(){return this.content[this.variant].text},action:function(){return this.content[this.variant].action}},methods:{close:function(){this.$emit("close")},bun:function(){console.log("bun0"),this.$emit("bun"),this.close()},remove:function(){this.$emit("remove"),this.close()}},template:"#remove-confirm"});Vue.component("remove-contact",{extends:RemoveConfirm,data:function(){return{content:{some:{caption:"Удалить навсегда",text:"Контакт будет удален без возможности восстановить. Дальнейшее общение с собеседником станет невозможно.\n                    Обменивайтесь реальными контактами с теми кто вам интересен всегда.",action:"Удалить навсегда"}}}},methods:{remove:function(){this.$emit("remove"),this.close()}},template:"#remove-confirm"});var SexConfirm=Vue.component("sex-confirm",(_defineProperty(_Vue$component={extends:ModalDialog,props:["show"],data:function(){return{sex:null}},computed:{variant:function(){return this.show?this.show:"message"},caption:function(){return this.content[this.variant].caption},text:function(){return this.content[this.variant].text}},methods:{close:function(){this.back()},index:function(t){return t==this.variant},verify:function(t){this.sex=t,this.processTimeout(),this.$refs.recaptcha.render(this.save),this.$refs.recaptcha.execute()},save:function(t){this.process=!0,this.sex&&(this.$store.dispatch("SAVE_SEX",{sex:this.sex,token:t}).then(function(t){t.data;app.$refs["api-key"].load()}),this.$root.reload(),this.$emit("select",this.show),this.redirect()),this.$refs.recaptcha.reset()},login:function(){this.$emit("login"),this.$emit("close")},redirect:function(){this.index("search")?this.$router.replace("/search"):this.index("account")?this.$router.replace("/settings/account"):this.index("message")?this.$router.replace("/"):this.index("city")?this.$router.replace("/wizard/city"):this.$router.replace("/")}}},"data",function(){var t={search:{caption:"Легко начать",text:"Для правильного отображения результатов поиска необходимо указать пол. Вы парень или девушка?"},contacts:{caption:"Вы девушка?",text:"Начало быстрого общения в один клик. Хотите получать сообщения и новые знакомства? Достаточно подтвердить, парень вы или девушка."},message:{caption:"Общение в один клик",text:"Начать общение просто. Хотите получать сообщения и новые знакомства? Достаточно подтвердить, парень вы или девушка."},account:{caption:"Кто вы?",text:"Приватная анкета в один клик. Самое быстрое общение. Достаточно указать кто вы, парень или девушка. И начинайте общаться."},register:{caption:"Очень легко!",text:"Самое быстрое общение. Приватная анкета в один клик. Достаточно указать, парень вы или девушка. И начинайте общаться."}};return t.city=t.contacts,{content:t}}),_defineProperty(_Vue$component,"template","#sex-confirm"),_Vue$component));Vue.component("simple-captcha",{props:[],data:function(){return{code:"",inc:0}},computed:{src:function(){return simple_hash(),"/capcha_pic.php?inc="+this.inc+"&hash="+hash}},mounted:function(){},methods:{close:function(){this.$emit("close")},update:function(){this.inc++},input:function(){this.$emit("input",this.code)}},template:"#simple-captcha"});var AdTop=Vue.component("ad-top",{data:function(){return{enabled:!0,iframe:!0,width:0,rotation:{desktop:[0,1]}}},mounted:function(){this.width=this.$el.offsetWidth,console.log("cc",[this.desktop,this.width])},methods:{random:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},computed:{desktop:function(){return 700<=this.width},banner:function(){return"ad-hm-"+this.random(0,2)+".gif"},source:function(){return"/static/img/ad/"+this.banner}},template:"#ad-top"});Vue.component("api-key-update",{props:["item"],data:function(){return{attempt:0}},mounted:function(){this.load()},methods:{tick:function(t){var e=this;setTimeout(function(){e.load()},1e3*t)},reload:function(){var t=1;10<=this.attempt?t=300:5<=this.attempt?t=5:2<=this.attempt&&(t=3),this.attempt++,this.tick(t)},load:function(){var i=this;this.$store.dispatch("auth/UPDATE_KEY").then(function(t){var e=t.data;e.uid?i.upKey(e):e.reg?i.noReg(e):i.reload()})},noReg:function(t){this.upKey(t),console.log("зарегистрирован / не авторизован")},upKey:function(t){this.$store.dispatch("LOAD_API_TOKEN"),this.upUser(t),this.upSettings(t),this.attempt=0,this.tick(600)},upUser:function(t){var e=t.uid,i=t.city,n=t.sex,s=t.age,o=t.name,a=t.contacts,r=t.apromt;this.$store.commit("resetUser",{uid:e,city:i,sex:n,age:s,name:o,contacts:a,promt:r})},upSettings:function(t){var e=t.up,i=t.to,n=t.any,s=t.virt;this.$store.commit("settings",{up:e,to:i,virt:s,any:n})}},template:"#api-key-update"});var MenuUser=Vue.component("menu-user",{data:function(){return{attempt:0}},mounted:function(){this.loadStatus()},computed:{authorized:function(){var t=this.$store.state.user.uid;this.$store.getters.registered;return 0<t?1:0},newMessage:function(){var t=this.$store.state.contacts.intimate.status;return 0==t||t<8},newContact:function(){var t=this.$store.state.contacts.initial.status;return 0==t||t<8},signature:function(){var t="Кто вы?",e=this.$store.state.user,i=e.name,n=e.city,s=e.age,o=e.sex;return o?(t=1==o?"Парень":"Девушка",(t=i||t)+" "+(s||"")+" "+(n||"")):t}},methods:{search:function(){this.$store.commit("simple",!0),this.$root.reload(),this.$router.push("/")},initial:function(){this.$router.push({name:"initial"})},intimate:function(){this.$router.push({name:"intimate"})},check:function(){var i=this;axios.get("/mailer/status").then(function(t){var e=t.data;i.onIntimate(e.message),i.onInitial(e.contact),i.attempt=0}).catch(function(){i.attempt++})},loadStatus:function(){var t=this,e=this.$store.state.user.uid,i=e?15:2;e&&this.check(),10<this.attempt?i=20:4<this.attempt?i=5:2<this.attempt&&(i=3),setTimeout(function(){t.loadStatus()},1e3*i)},onLoad:function(){},onIntimate:function(t){var e=this,i=this.$store.state.contacts.intimate,n=i.notified,s=i.status;if(this.$store.commit("intimate/status",t),n=!(!n||t!=s),1==t&&!n&&this.newMessage){this.$store.commit("intimate/notifi",!0),this.$emit("snackbar","Новое сообщение",function(){return e.$router.push({name:"intimate"})},"Смотреть",!0)}},onInitial:function(t){var e=this,i=this.$store.state.contacts.initial,n=i.notified,s=i.status;if(this.$store.commit("initial/status",t),n=!(!n||t!=s),1==t&&!n&&this.newContact&&!this.newMessage){this.$store.commit("initial/notifi",!0),this.$emit("snackbar","Новое знакомство",function(){return e.$router.push({name:"initial"})},"Смотреть",!0)}},regmy:function(){var e=this;app.$refs.recaptcha.render(function(t){return e.$store.dispatch("REGISTRATION",t)}),app.$refs.recaptcha.execute(),console.log("recaptcha начало проверки")}}}),PhotoViewer=Vue.component("photo-send",{props:["photo","options"],data:function(){return{remove:!1}},created:function(){this.server=this.$store.state.photoServer},computed:{uid:function(){return this.$store.state.user.uid}},methods:{close:function(){this.$emit("close")},removePhoto:function(){var e=this,t={headers:{Authorization:"Bearer "+this.$store.state.apiToken}};axios.delete("http://"+this.server+"/api/v1/users/"+this.uid+"/photos/"+this.photo.alias+".jpg",t).then(function(t){e.$emit("removed"),e.close()}).catch(function(t){console.log(t)})}},template:"#photo-send"});Vue.component("photo-view",{extends:ModalDialog,props:["photo","thumb","maxWidth","bypass"],methods:{approve:function(){this.$store.commit("accepts/photo")},close:function(){this.back()}},computed:{accept:function(){return!(!this.$store.state.accepts.photo&&!this.bypass)},background:function(){return this.thumb?{backgroundImage:"'url("+this.thumb+")'"}:null}},template:"#photo-view"}),Vue.component("recaptcha",{props:["success","failed","expired"],data:function(){return{sitekey:"6LdxP0YUAAAAAMzR_XFTV_G5VVOhyPnXLjdudFoe",widgetId:null,show:!0}},methods:{execute:function(){this.show=!0,window.grecaptcha.execute(this.widgetId)},reset:function(){window.grecaptcha.reset(this.widgetId),this.show=!1},verify:function(t){this.$store.commit("grecaptchaTokenUpdate",t),this.$emit("verify"),this.reset()},render:function(t){this.show=!0,null===this.widgetId&&window.grecaptcha&&(this.widgetId=window.grecaptcha.render("g-recaptcha",{sitekey:this.sitekey,size:"invisible",callback:t}),console.log("recaptcha ready",this.widgetId))}},template:"#recaptcha"}),Vue.component("title-mail",{props:["human"],data:function(){return{loading:!1}},mounted:function(){this.title()},watch:{human:function(){this.title()}},methods:{title:function(){if(this.human){var t="";this.human.name&&(t=this.human.name+" | "),this.human.sex?t+=2==this.human.sex?"Девушка":"Парень":t+="Парень или девушка",t+=" ";var e="";this.human.age&&(e=" "+moment.duration(this.human.age,"years").humanize());var i=" ищет ";this.human.city&&(i=" из города "+this.human.city+" ищет ");var n=" девушку или парня ";this.human.sex&&(n=2==this.human.sex?"парня":"девушку"),n+=" для секса или общения ";var s="";this.human.up&&this.human.to&&(s=" в возрасте от "+this.human.up+" до "+moment.duration(this.human.to,"years").humanize()),this.human.up&&!this.human.to&&(s=" в возрасте от "+moment.duration(this.human.up,"years").humanize()),!this.human.up&&this.human.to&&(s=" в возрасте до "+moment.duration(this.human.to,"years").humanize()),document.title=t+e+i+n+s}}},template:"<div></div>"}),Vue.component("search-item",{props:["human","visited","gold","compact"],data:function(){return{first:null,second:null,third:null,social:{first:["em","ok","vk","fb","go","sk","ph"],second:["vk","ok","fb","go","sk","ph"],third:["sk","ph","em","ok","vk","fb","go"]}}},mounted:function(){var i=this;_.find(_.pick(this.human,this.social.first),function(t,e){return!!t&&(i.first=e)}),_.find(_.pick(this.human,this.social.second),function(t,e){return!!(t=i.first!=e&&t)&&(i.second=e)}),_.find(_.pick(this.human,this.social.second),function(t,e){return t=i.first!=e&&t,!!(t=i.second!=e&&t)&&(i.third=e)})},computed:{search:function(){var t="парня ";return this.human.sex&&(t=2==this.human.sex?"парня ":"девушку "),this.human.who&&(t=1==this.human.who?"парня ":"девушку "),t="Ищет "+t,(this.human.up||this.human.to)&&(t+=this.human.up?" от "+this.human.up:"",t+=this.human.to?" до "+this.human.to:"",t+=" лет "),t},name:function(){var t=1==this.human.sex?"Парень":"Девушка";return this.human.name?this.human.name:t},tags:function(){return this.human.tags.length},online:function(){return this.human.last<777},differ:function(){result=!1;var t=this.$store.state.user.sex;return t&&this.human.who&&this.human.who!=t&&(result=!0),result}},methods:{close:function(){this.$emit("close")},quick:function(){this.$router.push({name:"quickWrite",params:{humanId:this.human.id}})},load:function(){var e=this;api.search.load(null).then(function(t){e.users=t.data.users})}},template:"#search-item"}),Vue.component("search-list",{data:function(){return{loading:!1,users:[],response:!0,error:0,newCount:0,attention:!1,toSlow:!1,humanId:null,account:null,sended:!1,ignore:!1}},mounted:function(){this.preload(),this.reload(),this.visitedSync(),this.$store.dispatch("desires/PICK")},computed:{items:function(){return this.$store.state.search.list},more:function(){return this.$store.getters["search/more"]},compact:function(){var t=this.$store.state.user,e=t.city,i=t.any;return e&&!i},visited:function(){return this.$store.state.visited.list},accept:function(){var t=this.$store.state.search,e=t.next,i=t.batch,n=this.$store.state.accepts.search;return!this.ignore&&!n&&i<e},defaults:function(){var t=defaultResults?json.parse(defaultResults):null;return t&&_.isObject(t)&&_.has(t,"users")&&t.users.length?t:[]},virgin:function(){return this.$store.getters["search/virgin"]},desires:function(){return _.pluck(this.$store.state.desires.list,"tag")},loader:function(){return this.$store.state.ready&&(!this.response||!this.items.length)},city:function(){return this.$store.state.user.city||defaultSettings.city},age:function(){return this.$store.state.user.age||defaultSettings.age},up:function(){return this.$store.state.user.up||defaultSettings.up||0},to:function(){return this.$store.state.user.to||defaultSettings.to||0},who:function(){return defaultSettings.who||null},userId:function(){return this.$store.state.user.uid||0}},methods:{reload:function(){this.$store.commit("ready",!1),this.$store.commit("search/reset",!1),this.load()},visitedSync:function(){this.$store.dispatch("visited/SYNC")},preload:function(){this.$store.commit("search/results",this.defaults),this.onLoad()},load:function(){var e=this;this.response=0;var t={who:this.who,city:this.city,up:this.up,to:this.to};this.$store.dispatch("search/LOAD",t).then(function(t){e.onLoad()}).catch(function(t){e.response=200,e.toSlow=!1})},loadNext:function(){this.load()},onLoad:function(){this.$store.commit("ready",!0),this.response=200,this.toSlow=!1},openMessage:function(t){this.humanId=t},noResult:function(){},old:function(t){return _.contains(this.visited,t)},gold:function(t){return!!_.intersection(this.desires,t).length},approve:function(){this.$store.commit("accepts/search")}},template:"#search-list"});var AboutSettings=Vue.component("about-settings",{props:[],data:function(){return{inputGrowth:"",inputWeight:"",selectFigure:null,process:!1,virgin:!0}},computed:Vuex.mapState({growth:function(t){return t.about.growth},weight:function(t){return t.about.weight},figure:function(t){return t.about.figure}}),mounted:function(){var t=this;this.$store.dispatch("about/SYNC").then(function(){t.init(),t.process=!1}).catch(function(){t.process=!1}),this.process=!0,this.init()},methods:{init:function(){this.inputGrowth=this.growth?this.growth:"",this.inputWeight=this.weight?this.weight:"",this.selectFigure=this.figure},deflower:function(){this.virgin=!1},close:function(){this.save(),this.$emit("close")},save:function(){this.virgin||this.$store.dispatch("about/SAVE",{growth:this.inputGrowth,weight:this.inputWeight,figure:this.selectFigure})}},template:"#about-settings"}),AccountSettings=Vue.component("account-settings",{extends:ClosedActivity,props:["root"],data:function(){return{selectCity:"",selectSex:0,selectAge:0,selectName:"",nameAlert:!1}},computed:Vuex.mapState({sex:function(t){var e=Number(t.user.sex);return e?1==e?1:2:0},city:function(t){return t.user.city},age:function(t){return t.user.age},name:function(t){var e=t.user.name,i=!e&&this.sex?this.autoName():"";return e||i}}),created:function(){var t=defaultSettings,e=t.city,i=t.age;this.selectCity=this.city?this.city:e,this.selectAge=this.age?this.age:i,this.selectSex=this.sex,this.selectName=this.name},methods:{autoName:function(){var t=[];t[1]=["Саша","Дима","Сергей","Иван","Максим","Валера","Николай"],t[2]=["Оля","Юля","Настя","Алена","Катя","Маргарита","Татьяна"];var e=Math.floor(7*Math.random());return this.sex?t[this.sex][e]:""},saveSex:function(){this.$store.dispatch("SAVE_SEX",{sex:this.selectSex,token:null}),this.resetName()},saveCity:function(t){t&&(this.selectCity=t),this.selectCity!=this.city&&(this.$store.dispatch("SAVE_CITY",this.selectCity),this.$root.reload())},saveAge:function(){this.selectAge!=this.age&&this.$store.dispatch("SAVE_AGE",this.selectAge)},saveName:function(){var t=this;this.$store.dispatch("SAVE_NAME",this.selectName).catch(function(){t.resetName(),t.nameAlert=!0})},resetName:function(){this.selectName=this.name},randomAge:function(){this.selectAge=_.random(19,30),this.saveAge()},save:function(){this.saveCity(),this.saveAge(),this.saveName()},close:function(){this.save(),this.back()}},template:"#account-settings"}),CityWizard=Vue.component("city-wizard",{extends:AccountSettings,data:function(){return{cities:["Москва","Санкт-Петербург","Минск","Алматы","Краснодар","Екатеринбург","Новосибирск","Киев","Омск","Воронеж","Нижний Новгород","Бишкек","Челябинск","Самара","Красноярск","Уфа","Казань","Иркутск","Волгоград","Харьков","Саратов","Ростов-на-Дону","Одесса","Барнаул","Пермь","Тюмень","Ташкент","Гомель","Томск","Хабаровск","Тольятти","Астана","Ставрополь","Тула","Астрахань","Гродно","Пенза","Оренбург","Владивосток","Чита","Рязань","Караганда","Тверь","Ульяновск","Кемерово","Сургут","Ярославль","Улан-Удэ","Брянск","Шымкент","Витебск","Симферополь","Калининград","Сочи","Липецк","Ижевск","Курск","Белгород","Павлодар","Брест","Могилев","Запорожье","Киров","Новокузнецк","Кривой Рог","Калуга","Усть-Каменогорск","Севастополь","Тамбов","Днепропетровск","Чебоксары","Иваново","Смоленск","Донецк","Душанбе","Владимир","Орел","Магнитогорск","Кострома","Нижневартовск"]}},methods:{select:function(t){this.saveCity(t),this.back()},close:function(){this.saveCity(),this.back()}},template:"#city-wizard"}),DesiresSettings=Vue.component("desires-settings",{props:[],data:function(){return{process:!1,desire:"",confirmRemove:null}},computed:Vuex.mapState({tags:function(t){return t.desires.list}}),mounted:function(){var e=this;this.process=!0,this.$store.dispatch("desires/SYNC").then(function(t){e.process=!1})},methods:{close:function(){this.$emit("close")},add:function(t){var e=this;this.process=!0,this.$store.dispatch("desires/ADD",t).then(function(t){e.process=!1})},remove:function(){this.$store.dispatch("desires/DELETE",this.confirmRemove),this.confirmRemove=null}},template:"#desires-settings"}),EnvelopSettings=Vue.component("envelop-settings",{extends:ClosedActivity,template:"#envelop-settings"}),IncomingPhoto=Vue.component("incoming-photo",{extends:ClosedActivity,props:["humanId"],data:function(){return{photos:[],user:0,server:null,preview:null}},created:function(){this.server=this.$store.state.photoServer},mounted:function(){this.loadPhoto()},computed:{uid:function(){return this.$store.state.user.uid}},methods:{loadPhoto:function(){var e=this,t={headers:{Authorization:"Bearer "+this.$store.state.apiToken},params:{tid:this.humanId,hash:hash}};axios.get("http://"+this.server+"/api/v1/users/"+this.uid+"/sends",t).then(function(t){e.photos=t.data.photos}).catch(function(t){console.log(t)})},show:function(t){var e=this.photos[t],i=e._links;if(i.origin.href){var n={thumb:i.thumb.href,photo:i.origin.href,alias:e.alias,height:e.height,width:e.width};this.preview=n}},close:function(){this.back()}},template:"#incoming-photo"}),LoginAccount=Vue.component("login-account",{props:[],data:function(){return{login:"",password:"",captcha:!1,code:"",error:!1,remind:!1,hint:"Введите данные"}},computed:Vuex.mapState({city:function(t){return t.user.city}}),mounted:function(){},methods:{close:function(){this.$emit("close")},send:function(){var e=this,t={login:this.login,pass:this.password,captcha:this.code};api.user.post(t,null,"sync/login").then(function(t){e.hint=t.data.say,e.error=t.data.err,e.captcha=t.data.captcha,e.onLogin()})},onLogin:function(){this.$refs.captcha.update(),this.error||(this.hint="Успешно. Подождите.",location.href="/")},setCode:function(t){this.code=t}},template:"#login-account"}),MessagesCliche=Vue.component("messages-cliche",{props:[],extends:ActivityActions,data:function(){return{texts:[],version:3,active:null,process:!0,default:{size:12,color:"4E8714",tab:"public"}}},mounted:function(){var t=ls.get("cliche-active");this.load(t)},computed:{},methods:{load:function(t){var i=this,n=t||this.default.tab;api.raw.load(null,"static/json/cliche/"+n+".json?v="+this.version).then(function(t){var e=t.data;i.texts=e,i.active=n,ls.set("cliche-active",i.active,259200)})},size:function(t){return(t?this.default.size+t:this.default.size)+"px"},color:function(t){return"#"+(t||this.default.color)},style:function(t){return{fontSize:this.size(t.size),color:this.color(t.color)}},buttonStyle:function(t){return this.active==t?"btn-primary":"btn-default"},select:function(t){this.$emit("select",t),this.close()}},template:"#messages-cliche"}),Notepad=Vue.component("notepad",{props:[],extends:ActivityActions,data:function(){return{writes:[]}},mounted:function(){var e=this;this.$store.dispatch("notes/WRITES").then(function(t){e.writes=t})},computed:{},methods:{cliche:function(){this.$emit("cliche"),this.close()},select:function(t){this.$emit("select",t),this.close()}},template:"#notepad"}),OtherSettings=Vue.component("other-settings",{props:[],data:function(){return{}},computed:Vuex.mapState({uid:function(){return this.$store.state.user.uid}}),methods:{close:function(){this.$emit("close")},logout:function(){window.location="/logout.php"}},template:"#other-settings"}),PhotoSettings=Vue.component("photo-settings",{extends:ClosedActivity,props:["humanId"],data:function(){return{photos:[],photoAlert:!1}},computed:Vuex.mapState({}),mounted:function(){console.log("fileupload");var s=this;$("#fileupload").fileupload({dataType:"json",add:function(t,e){var i=s.$store.state.photoServer,n=s.$store.state.user.uid;e.url="http://"+i+"/api/v1/users/"+n+"/photos?jwt="+s.$store.state.apiToken,e.submit()},done:function(t,e){s.preview(e.result.photo)},fail:function(){s.failed()}}),this.loadPhoto()},methods:{close:function(){this.back()},loadPhoto:function(){var i=this,t=this.$store.state.photoServer,e=this.$store.state.user.uid,n={headers:{Authorization:"Bearer "+this.$store.state.apiToken},params:{hash:hash}};axios.get("http://"+t+"/api/v1/users/"+e+"/photos",n).then(function(t){var e=t.data.photos;e&&e.length&&(i.photos=t.data.photos),console.log(i.photos)}).catch(function(t){console.log(t)})},upload:function(t){$("#fileupload").click()},show:function(t){this.preview(this.photos[t])},preview:function(t){var e=t._links;if(e.origin.href){var i={photo:e.origin.href,thumb:e.thumb.href,alias:t.alias,height:t.height,width:t.width};this.$emit("select",i),this.close()}else this.close()},failed:function(){this.photoAlert=!0}},template:"#photo-settings"});Vue.component("upload-dialog",{template:"#upload-dialog",data:function(){return{photos:[],server:null}},created:function(){this.server=this.$store.state.photoServer},methods:{show:function(t){this.preview(this.photos[t])},preview:function(t){var e=t._links;if(e.origin.href){var i={photo:e.origin.href,thumb:e.thumb.href,alias:t.alias,height:t.height,width:t.width};this.$store.commit("sendPhoto",i)}this.close()}}});var storage,ReviewSettings=Vue.component("review-settings",{extends:ClosedActivity,props:[],data:function(){return{text:"",needResponse:!1,sended:!1,isEmpty:!1}},mounted:function(){this.flash()},methods:{flash:function(){var t=ls.get("review-text");this.text=t||""},handle:function(){this.text?this.send():this.isEmpty=!0},send:function(){var e=this;api.raw.post({text:this.text,hash:hash},null,"security/remark").then(function(t){t.data;e.process=!1,e.text="",ls.remove("review-text")}),this.isEmpty=!1,this.process=!0,this.sended=!0},noResponse:function(){this.needResponse=!1},switchToQuestions:function(){ls.set("review-text",this.text,5),this.$router.push("question")}},template:"#review-settings"}),SearchSettings=Vue.component("search-settings",{extends:ClosedActivity,props:["root"],data:function(){return{ageRange:[0,16,17,18,20,23,25,27,30,35,40,45,50,60,80],selectUp:0,selectTo:0,selectCity:"",checkedAny:0,checkedVirt:0,tooltip:{any:!1,virt:!1}}},computed:Vuex.mapState({userSex:function(t){return Number(t.user.sex)},who:function(){return this.userSex?1==this.userSex?2:1:0},city:function(t){var e=defaultSettings.city;return t.user.city?t.user.city:e},up:function(t){return this.age(t.user.up)},to:function(t){return this.age(t.user.to)},any:function(t){return t.user.any},virt:function(t){return 1==t.user.virt},virgin:function(t){return t.user.city==this.city&&(t.user.up==this.up&&(t.user.to==this.to&&(this.selectCity==this.city&&this.selectUp==this.up&&this.selectTo==this.to&&this.checkedAny==this.any&&this.checkedVirt==this.virt)))}}),created:function(){var t=defaultSettings,e=t.city,i=t.up,n=t.to;this.selectCity=this.city?this.city:e,this.selectUp=this.up?this.up:this.age(i),this.selectTo=this.to?this.to:this.age(n),this.checkedAny=this.any,this.checkedVirt=this.virt},methods:{age:function(n){if(!(n=Number(n)))return 0;var t=_.min(this.ageRange),e=_.max(this.ageRange);return n<=t?t:e<=n?e:_.find(this.ageRange,function(t,e,i){if(e&&e<i.length&&n>i[e-1]&&n<i[e+1])return!0})},save:function(){var t={up:this.selectUp,to:this.selectTo,any:this.checkedAny,virt:this.checkedVirt};console.log(t),this.virgin||(this.$store.dispatch("SAVE_SEARCH",t),console.log(this.$store.state.user))},close:function(){this.save(),this.back(),this.$root.reload()},tooltipAnyForce:function(){this.checkedAny&&(this.tooltip.any=!0)},tooltipVirtForce:function(){this.checkedVirt&&(this.tooltip.virt=!0)}},template:"#search-settings"}),SecuritySettings=Vue.component("security-settings",{props:[],data:function(){return{inputLogin:"",inputPasswd:"",inputEmail:"",checkSubscribe:0,process:!1,processLogin:!1,processPasswd:!1,processEmail:!1,confirmRemove:!1,virgin:!0}},computed:Vuex.mapState({login:function(t){return t.auth.login},passwd:function(t){return t.auth.pass},email:function(t){return t.auth.email},promt:function(t){return t.auth.promt},subscr:function(t){return t.auth.subscr}}),mounted:function(){var t=this;console.log("auth/SYNC"),this.$store.dispatch("auth/SYNC").then(function(){t.init(),t.process=!1}).catch(function(){t.process=!1}),this.process=!0,this.init()},methods:{init:function(){this.inputLogin=this.login,this.inputPasswd=this.passwd,this.inputEmail=this.email,this.checkSubscribe=this.subscr},deflower:function(){this.virgin=!1},saveLogin:function(){var i=this;this.processLogin=!0,this.$store.dispatch("auth/SAVE_LOGIN",this.inputLogin).then(function(t){var e=t.data;e.say&&i.$emit("warning",e.say),i.processLogin=!1}).catch(function(){i.processLogin=!1})},savePasswd:function(){var i=this;this.processPasswd=!0,this.$store.dispatch("auth/SAVE_PASSWD",this.inputPasswd).then(function(t){var e=t.data;e.say&&i.$emit("warning",e.say),i.processPasswd=!1}).catch(function(){i.processPasswd=!1})},saveEmail:function(){var i=this;this.processEmail=!0,this.$store.dispatch("auth/SAVE_EMAIL",this.inputEmail).then(function(t){var e=t.data;e.err&&i.$emit("warning",e.say),i.processEmail=!1}).catch(function(){i.processEmail=!1})},removeEmail:function(){var i=this;this.confirmRemove=!1,this.processEmail=!0,this.$store.dispatch("auth/REMOVE_EMAIL").then(function(t){var e=t.data;e.err&&i.$emit("warning",e.say),i.processEmail=!1}).catch(function(){i.processEmail=!1})},saveSubscribe:function(){this.$store.dispatch("auth/SAVE_SUSCRIBE")},close:function(){this.processLogin||this.processPasswd||this.processEmail?this.$emit("alert","Подождите, сохраняю."):this.$emit("close")}},template:"#security-settings"}),SocialSettings=Vue.component("social-settings",{props:[],data:function(){return{checkedContact:{em:0,vk:0,ok:0,fb:0,go:0,sk:0,ph:0},virgin:!0}},computed:Vuex.mapState({contacts:function(t){return t.user.contacts}}),mounted:function(){console.log("user",this.contacts),this.checkedContact=this.contacts},methods:{close:function(){this.save(),this.$emit("close")},deflower:function(){this.virgin=!1},save:function(){this.virgin||this.$store.dispatch("SAVE_CONTACTS",this.checkedContact)}},template:"#social-settings"});Vue.component("slider-vertical",{data:function(){return{slide:1}}}),Vue.component("suggest-input",{props:["url","disabled","tags"],data:function(){return{query:"",items:[],enable:!0,init:!0}},computed:{suggested:function(){return this.items.length}},methods:{load:function(){var e=this;api.user.get({q:this.query},"tag/suggest").then(function(t){e.loaded(t.data)})},reset:function(){this.query="",this.items=[]},clear:function(){this.items=[]},suggest:_.debounce(function(){this.init=!1,this.load()},500),select:function(t){this.saved(t)||this.$emit("select",t),this.reset()},loaded:function(t){t&&t.length&&(this.items=t)},saved:function(t){return!!_.findWhere(this.tags,{tag:t})}},template:"#suggest-input"}),Vue.component("alert-widget",{data:function(){return{compact:!1}},mounted:function(){this.compact=!0}}),Vue.component("auth-board",{data:function(){return{confirmSend:!1,hint:"Введите ваш емаил.",process:!1,email:""}},mounted:function(){var t=this;_.delay(function(){t.$store.dispatch("auth/SYNC").then(function(){t.email=t.$store.state.auth.email})},2500)},computed:{login:function(){return this.$store.state.auth.login},password:function(){return this.$store.state.auth.pass},loaded:function(){return this.login&&this.password}},methods:{send:function(){var e=this;this.email&&(this.process=!0,this.hint="Отправляю...",this.$store.dispatch("auth/SAVE_EMAIL",this.email).then(function(t){e.hint=t.data.say,e.error=t.data.err,e.sended()}))},sended:function(){this.process=!1,this.error||this.emit("close")}},template:"#auth-board"}),Vue.component("desires-widget",{props:["tags"],data:function(){return{batch:50,position:0,list:[]}},mounted:function(){this.reload()},updated:function(){this.reload()},computed:{avaible:function(){var t=this.tags.length-this.position;return 0<t?t:0},more:function(){return!!this.tags&&this.avaible},offset:function(){var t=this.batch;return this.list.length&&this.list.length<this.batch&&(t=this.batch-this.list.length),t},next:function(){var t=this.tags.slice(this.position,this.position+this.offset);return _.shuffle(t)}},methods:{load:function(){this.more&&(this.list=_.union(this.list,this.next),this.position=this.list.length)},reload:function(){this.position&&this.offset==this.batch||this.load()}},template:"#desires-widget"}),Vue.component("info-widget",{data:function(){return{enable:!0,version:"2017-12-01",users:{idUp:null,idTo:673e5,sex:null,city:[]},accept:!0}},mounted:function(){this.accept=ls.get("release-info")<=this.version},computed:{userId:function(){return this.$store.state.user.uid},sex:function(){return this.$store.state.user.sex},city:function(){return this.$store.state.user.city},show:function(){return this.enable&&!this.accept&&this.forId(this.userId)}},methods:{forId:function(t){var e=!0;return(this.users.idUp||this.users.idTo)&&(e=!1),t&&(e=this.users.idUp?t>this.users.idUp:e,e=this.users.idTo?t<this.users.idTo:e),e},confirm:function(){ls.set("release-info",this.version),this.accept=!0},more:function(){this.$router.push("/releases/"+this.version)}},template:"#info-widget"}),Vue.component("intro-info",{data:function(){return{slide:1}}}),Vue.component("search-wizard",{data:function(){return{}},store:store,computed:Vuex.mapState({range:function(t){var e=t.user.up,i=t.user.to,n="";return e&&i?n=e+" - "+i:e&&!i?n=" от "+e:!e&&i&&(n=" до "+i),n?" в возрасте "+n+" лет ":""},who:function(t){var e=t.user.sex,i=" знакомства с кем угодно ";return e&&(i=2==e?" знакомства с парнем ":" знакомства с девушкой "),i},say:function(t){var e=t.user.city?"":", из любого города ";return this.who+this.range+e},desires:function(){var t=this.$store.state.desires.list.length;return t||0}}),mounted:function(){}}),Vue.component("snackbar",{props:["callback","action","play"],computed:{time:function(){return this.callback?5e3:3e3},title:function(){return this.action?this.action:"Ok"}},methods:{close:function(){this.$emit("close")},approve:function(){this.callback()},autoplay:function(t){this.play&&this.$refs.autoplay.play()}},mounted:function(){_.delay(this.close,this.time),this.autoplay()},template:"#snackbar"}),Vue.component("toast",{methods:{close:function(){this.$emit("close")}},mounted:function(){_.delay(this.close,2e3)},template:"#toast"}),Vue.component("tooltip",{props:["text","force"],data:function(){return{show:!1}},methods:{close:function(){this.show=!1,this.$emit("close")}},template:"#tooltip"}),Vue.component("photo-dialog",{methods:{close:function(){this.$emit("close"),store.commit("viewPhoto",{photo:null})}},computed:Vuex.mapState({config:function(t){return t.photoView}}),template:"#photo-dialog"}),(storage={enable:0,init:function(){storage.is_enable()&&(storage.enable=1)},is_enable:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},save:function(t,e){storage.enable&&localStorage.setItem(t,e)},load:function(t,e){var i=e||null;return storage.enable&&localStorage.getItem(t)&&(i=localStorage.getItem(t)),i},set:function(t,e){storage.save(t,e)},get:function(t,e){storage.load(t,e)},array:{load:function(t){var e=[],i=null;return i=storage.load(t),(i=json.parse(i))&&(e=i),e},save:function(t,e){storage.save(t,json.encode(e))},add:function(t,e){}}}).init();var about={namespaced:!0,state:{growth:0,weight:0,figure:0},actions:{SYNC:function(t){t.rootState;var e=t.commit;t.getters;return api.user.syncAbout().then(function(t){e("update",t.data)})},SAVE:function(t,e){t.state;var i=t.commit;api.user.saveAbout({anketa:e}).then(function(t){i("update",e)})}},mutations:{update:function(t,e){e&&_.assign(t,e)}}},accepts={namespaced:!0,state:{photo:!1,search:!1,moderator:!1,settings:!1},actions:{LOAD:function(t){var e=t.state,i=ls.get("accepts");i&&_.assign(e,i)}},mutations:{photo:function(t){t.photo=!0,ls.set("accepts",t)},search:function(t){t.search=!0,ls.set("accepts",t)},moderator:function(t,e){t.moderator=1==e,ls.set("accepts",t)},settings:function(t){t.settings=!0,ls.set("accepts",t)}}},auth={namespaced:!0,state:{iss:"",exp:"",iat:"",sid:"",uid:"",auth:"",ip:"",login:"",pass:"",email:"",promt:"",subscr:!1,last:"",error:""},actions:{SYNC:function(t){var e=t.commit;return api.user.syncAuth().then(function(t){e("update",t.data)})},SAVE_LOGIN:function(t,e){t.commit;return api.user.saveLogin(e)},SAVE_PASSWD:function(t,e){t.commit;return api.user.savePasswd(e)},SAVE_EMAIL:function(t,e){t.commit;return api.user.saveEmail(e)},REMOVE_EMAIL:function(t){t.commit;return api.user.removeEmail()},SAVE_SUSCRIBE:function(t,e){t.store;return(0,t.commit)("subscr"),api.user.saveSubscribe()},UPDATE_KEY:function(t){t.store,t.commit;return axios.get("/sync/sess/")}},mutations:{update:function(t,e){e&&_.assign(t,e)},subscr:function(t){t.subscr=!t.subscr}}},mutations={load:function(t,e){e&&e instanceof Array&&0<e.length&&(t.list=e)},add:function(t,e){e&&e instanceof Array&&0<e.length&&(t.list=_.union(t.list,e))},status:function(t,e){t.status=e},notifi:function(t,e){t.notified=1==e}},initial=_.extend({namespaced:!0,state:{status:8,notified:!1,list:[]},actions:{LOAD:function(t){var e=t.state,i=t.commit,n=t.rootState;return i("load",ls.get("initial-contacts")),api.contacts.initial.cget({uid:n.user.uid,offset:0}).then(function(t){i("load",t.data),ls.set("initial-contacts",e.list)})},NEXT:function(t,e){t.state;var i=t.commit,n=t.rootState;return api.contacts.initial.cget({uid:n.user.uid,offset:e}).then(function(t){i("add",t.data)})},DELETE:function(t,e){var i=t.state,n=t.commit,s=t.rootState,o=api.contacts.initial.delete({uid:s.user.uid,resource_id:i.list[e].id});return n("delete",e),o},READ:function(t,e){var i=t.state,n=t.commit,s=t.rootState,o=api.contacts.initial.put(null,{uid:s.user.uid,resource_id:i.list[e].id});return n("read",e),o},CHECK:function(t){var e=t.commit;axios.get("/mailer/check_contact").then(function(){e("status",8),e("notifi",!1)})}},mutations:_.extend({delete:function(t,e){t.list.splice(e,1),ls.set("initial-contacts",t.list)},read:function(t,e){t.list[e].message&&(t.list[e].message.unread=0,ls.set("initial-contacts",t.list))}},mutations)}),intimate=_.extend({namespaced:!0,state:{status:8,notified:!1,list:[]},actions:{LOAD:function(t){var e=t.state,i=t.commit,n=t.rootState;return i("load",ls.get("intimate-contacts")),api.contacts.intimate.cget({uid:n.user.uid,offset:0}).then(function(t){i("load",t.data),ls.set("intimate-contacts",e.list)})},NEXT:function(t,e){t.state;var i=t.commit,n=t.rootState;return api.contacts.intimate.cget({uid:n.user.uid,offset:e}).then(function(t){i("add",t.data)})},DELETE:function(t,e){var i=t.state,n=t.commit,s=t.rootState,o=api.contacts.intimate.delete({uid:s.user.uid,resource_id:i.list[e].id});return n("delete",e),o},READ:function(t,e){var i=t.state,n=t.commit,s=t.rootState,o=api.contacts.intimate.put(null,{uid:s.user.uid,resource_id:i.list[e].id});return n("read",e),o},CHECK:function(t){var e=t.commit;axios.get("/mailer/check_message").then(function(){e("status",8),e("notifi",!1)})}},mutations:_.extend({delete:function(t,e){t.list.splice(e,1),ls.set("intimate-contacts",t.list)},read:function(t,e){t.list[e].message&&(t.list[e].message.unread=0,ls.set("intimate-contacts",t.list))}},mutations)}),sends=_.extend({namespaced:!0,state:{list:[]},actions:{LOAD:function(t){var e=t.state,i=t.commit,n=t.rootState;return i("load",ls.get("sends-contacts")),api.contacts.sends.cget({uid:n.user.uid,offset:0}).then(function(t){i("load",t.data),ls.set("sends-contacts",e.list)})},NEXT:function(t,e){t.state;var i=t.commit,n=t.rootState;return api.contacts.sends.cget({uid:n.user.uid,offset:e}).then(function(t){i("add",t.data)})},DELETE:function(t,e){var i=t.state,n=t.commit,s=t.rootState,o=api.contacts.sends.delete({uid:s.user.uid,resource_id:i.list[e].id});return n("delete",e),o}},mutations:_.extend({delete:function(t,e){t.list.splice(e,1),ls.set("sends-contacts",t.list)}},mutations)}),contacts={modules:{initial:initial,intimate:intimate,sends:sends}},credits={state:{count:0,info:""},actions:{},mutations:{}},desires={namespaced:!0,state:{list:[],limit:20},actions:{PICK:function(t){(0,t.commit)("update",ls.get("desires"))},SYNC:function(t){var e=t.state,i=t.commit;return i("update",ls.get("desires")),api.user.desireList().then(function(t){i("update",t.data),ls.set("desires",e.list)})},ADD:function(t,i){t.state;var n=t.commit;return api.user.desireAdd(i).then(function(t){var e=t.data.id;n("add",{id:e,tag:i})})},DELETE:function(t,e){var i=t.state,n=t.commit,s=api.user.desireDelete(i.list[e].id);return n("delete",e),s}},mutations:{update:function(t,e){e&&e.length&&(t.list=e.slice())},add:function(t,e){t.list.unshift(e),t.list=t.list.slice(0,t.limit),ls.set("desires",t.list)},delete:function(t,e){t.list.splice(e,1),ls.set("desires",t.list)}},getters:{tags:function(t){return _.pluck(t.list,"tag")}}},modals={state:{initial:!1,intimate:!1,sends:!1},mutations:{showInitial:function(t,e){store.commit("closeAll"),t.initial=1==e},showIntimate:function(t,e){store.commit("closeAll"),t.intimate=1==e},showSends:function(t,e){store.commit("closeAll"),t.sends=1==e},closeAll:function(t){t.initial=!1,t.intimate=!1,t.sends=!1}}},moderator={state:{promt:0,rank:0,resident:0,action:0,effect:0,bunn:0,rang:""},actions:{},mutations:{}},notes={namespaced:!0,state:{db:null},actions:{INIT:function(t){var i=t.state,n=t.commit,e=t.rootState;api.raw.load(null,"static/json/notes/"+e.locale+".json").then(function(t){var e=t.data;i.db.transaction("rw",i.db.writes,function(){_.each(e.reverse(),function(t,e,i){n("add",t)})})})},LOAD:function(t){var e=t.state,i=t.dispatch,n=t.rootState.user.uid;e.db=new Dexie("DataBaseFS__"+n),e.db.version(1).stores({writes:"++id, &text, count, updated"}),e.db.on("ready",function(){e.db.writes.count(function(t){t||i("INIT")})}),e.db.open()},WRITES:function(t){return t.state.db.writes.orderBy("updated").reverse().limit(100).sortBy("count")},ITEM:function(t,e){var i=t.state;t.commit;return i.db.writes.get(e)},UPDATE:function(t,e){var i=t.state,n=t.commit,s=getTimestamp();i.db.writes.get({text:e}).then(function(t){t?(count=t.count?t.count:0,count+=1,i.db.writes.update(t.id,{count:count,updated:s})):n("add",e)})}},mutations:{add:function(t,e){var i=getTimestamp();t.db.writes.add({text:e,count:0,updated:i})}}},search={namespaced:!0,state:{list:[],last:[],received:0,next:null,batch:15,url:"",human:{name:"",age:0,city:""}},actions:{HUMAN:function(t,e){var i=t.commit,n="human.data."+e;i("resetHuman",e),console.log("HUMAN actions",e),api.search.get({tid:e}).then(function(t){var e=t.data;i("setHuman",e),ls.set(n,e,1500)}),i("setHuman",ls.get(n))},LOAD:function(t,e){var i=t.state,n=t.rootState,s=t.commit;store.dispatch("LOAD_USER");var o=n.user,a=o.sex,r=o.any,c=o.virt,u=e.who,h=e.city,l=e.up,d=e.to;return a&&(u=2==a?1:2),h&&!r||(h=null),console.log("SRCH-LOAD",{who:u,sex:a,city:h,up:l,to:d,any:r,virt:c}),console.log("User.data",ls.get("user.data")),api.search.load({who:u,city:h,up:l,to:d,next:i.next}).then(function(t){var e=t.data;s("results",e),s("last",e),s("next")})}},mutations:{reset:function(t){t.next=0,t.list=[],t.received=0},resetHuman:function(t,e){t.human&&t.human.id!=e&&(t.human={})},setHuman:function(t,e){e&&(t.human=e,console.log("HUMAN",e))},results:function(t,e){var i=e.users;t.received=i?i.length:0,i&&t.received&&(t.list=_.union(t.list,i))},last:function(t,e){var i=e.users;i&&!t.last&&(t.last=i,ls.set("last-search",i,2678400))},next:function(t,e){e?t.next=0:t.next+=t.batch}},getters:{virgin:function(t,e,i){var n=i.user,s=n.city,o=n.up,a=n.to;return!s&&!o&&!a},more:function(t){return!(!t.received||t.received!=t.batch)},tags:function(t){return _.compact(_.union(_.flatten(_.pluck(t.list,"tags"))))}}},user={state:{uid:0,sex:0,age:0,name:"",city:"",up:null,to:null,any:0,virt:0,contacts:{em:0,vk:0,ok:0,fb:0,go:0,sk:0,ph:0},tags:{str:""},status:0,promt:null,last:""},actions:{LOAD_USER:function(t){(0,t.commit)("loadUser",ls.get("user.data"))},REGISTRATION:function(t,e){t.state,t.commit;e&&api.user.regnow(e).then(function(t){t.data;location.reload()})},SAVE_SEX:function(t,e){t.state;var i=t.commit,n=e.sex,s=e.token;return i("loadUser",{sex:n,name:""}),api.user.saveSex(n,s)},SAVE_AGE:function(t,e){var i=t.state,n=t.commit;e&&i.age!=e&&(api.user.saveAge(e).then(function(t){}),n("loadUser",{age:e}))},SAVE_NAME:function(t,e){var i=t.state,n=t.commit;if(e&&i.name!=e)return api.user.saveName(e).then(function(){n("loadUser",{name:e})})},SAVE_CITY:function(t,e){var i=t.state,n=t.commit;e&&i.city!=e&&(api.user.saveCity(e).then(function(t){}),n("loadUser",{city:e}))},SAVE_CONTACTS:function(t,e){t.state;var i=t.commit;api.user.saveContacts(e).then(function(t){}),i("loadUser",{contacts:e})},SAVE_SEARCH:function(t,e){t.state;return(0,t.commit)("loadUser",e),api.user.saveSearch(e).then(function(t){})}},mutations:{loadUser:function(t,e){_.assign(t,e),ls.set("user.data",t,23456)},resetUser:function(t,e){_.assign(t,e),ls.set("user.data",t,23456)},settings:function(t,e){_.assign(t,e),ls.set("user.data",t,23456)}}},visited={namespaced:!0,state:{list:[]},actions:{SYNC:function(t){var e=t.rootState,i=t.state,n=t.commit,s="visited-"+e.user.uid;return n("update",ls.get(s)),api.user.visitedList().then(function(t){var e=t.data;n("update",e),ls.set(s,i.list,2678400)})},ADD:function(t,e){var i=t.rootState,n=t.state,s=t.commit,o=i.user.uid,a="visited-"+o;return s("add",e),ls.set(a,n.list,2678400),api.user.visitedAdd(o,e).then(function(t){})}},mutations:{update:function(t,e){e&&e.length&&(t.list=_.union(t.list,e))},add:function(t,e){t.list.unshift(e)}}};moment.locale("ru");var ls=lscache,store=new Vuex.Store({modules:{user:user,auth:auth,about:about,search:search,contacts:contacts,desires:desires,visited:visited,accepts:accepts,modals:modals,notes:notes},state:{ready:!1,locale:"ru",apiToken:"",grecaptchaToken:null,photoServer:"photo.a4sex.net",simple:!1},actions:{LOAD_API_TOKEN:function(t){(0,t.commit)("setApiToken",{apiToken:get_cookie("jwt")})}},mutations:{setApiToken:function(t,e){e&&_.assign(t,e)},simple:function(t,e){t.simple=1==e},ready:function(t,e){t.ready=1==e},grecaptchaTokenUpdate:function(t,e){e&&(t.grecaptchaToken=e)}},getters:{registered:function(t){return!!t.apiToken}}});store.dispatch("LOAD_API_TOKEN"),store.dispatch("accepts/LOAD"),store.dispatch("LOAD_USER");var Api=function(){function s(t,e,i,n){_classCallCheck(this,s),t=t||"/",this.setDelay("0"),this.setRoot(t,i),this.setConfig(this.root,e),this.setRouting(n)}return _createClass(s,[{key:"setDelay",value:function(t){this.wait=1e3*t}},{key:"setRouting",value:function(t){this.routing={route:"",load:"",get:"{resource_id}",cget:"",send:"",post:"",save:"",remove:"",delete:"{resource_id}",put:"{resource_id}",patch:"{resource_id}",option:"{resource_id}"},_.extend(this.routing,t)}},{key:"setRoot",value:function(t,e){var i=e?"v"+e+"/":"";this.root=t+i}},{key:"setConfig",value:function(t,e){this.config={baseURL:t,headers:{Authorization:"Bearer "+e}}}},{key:"setBaseURL",value:function(t){_.extend(this.config,{baseURL:t})}},{key:"setAuthKey",value:function(t){_.extend(this.config.headers,{Authorization:"Bearer "+t}),this.key=t}},{key:"setParams",value:function(n,t){var e=t.replace(/\{(.*?)\}/gi,function(t,e){var i=n[e];return delete n[e],i});return this.config.params=n||{},e}},{key:"setUrl",value:function(t,e,i){this.refresh();var n=this.routing.route;if(i)result=i;else{var s=this.routing[t];result=n||"",result&&s?result=result+"/"+s:s&&(result=s)}return result=this.setParams(e,result),this.root+result}},{key:"get",value:function(t,e){return this.delay(axios.get(this.setUrl("get",t,e),this.config),0)}},{key:"load",value:function(t,e){return this.delay(axios.get(this.setUrl("load",t,e),this.config),0)}},{key:"cget",value:function(t,e){return this.delay(axios.get(this.setUrl("cget",t,e),this.config),0)}},{key:"send",value:function(t,e){return this.delay(axios.get(this.setUrl("send",t,e),this.config),0)}},{key:"post",value:function(t,e,i){return this.delay(axios.post(this.setUrl("post",e,i),t,this.config),0)}},{key:"save",value:function(t,e,i){return this.delay(axios.post(this.setUrl("save",e,i),t,this.config),0)}},{key:"remove",value:function(t,e,i){return this.delay(axios.post(this.setUrl("remove",e,i),t,this.config),0)}},{key:"delete",value:function(t,e){return this.delay(axios.delete(this.setUrl("delete",t,e),this.config),0)}},{key:"put",value:function(t,e,i){return this.delay(axios.put(this.setUrl("put",e,i),t,this.config),0)}},{key:"patch",value:function(t,e,i){return this.delay(axios.patch(this.setUrl("patch",e,i),t,this.config),0)}},{key:"request",value:function(t,e,i,n,s){return i?this.delay(axios[t](this.setUrl(e,n,s),i,this.config),0):this.delay(axios[t](this.setUrl(e,n,s),this.config),0)}},{key:"option",value:function(){}},{key:"delay",value:function(i,t){var n=t||this.wait;return n<this.wait&&(n=this.wait),0==n||"undefined"==typeof Promise?i:new Promise(function(t,e){_.delay(t,n,i)})}},{key:"refresh",value:function(){store.dispatch("LOAD_API_TOKEN")}}]),s}(),ApiBun=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"/","1234"))}return _inherits(e,Api),_createClass(e,[{key:"send",value:function(t){return axios.post("mess/bun/",t,this.config)}}]),e}(),ApiMessages=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"/","1234"))}return _inherits(e,Api),_createClass(e,[{key:"send",value:function(t){return this.post(t,null,"mailer/post/")}}]),e}(),ApiModerator=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"/","1234"))}return _inherits(e,Api),_createClass(e,[{key:"promt",value:function(){return this.post(null,null,"moder/promt")}},{key:"load",value:function(){return this.post(null,null,"moder/auth")}},{key:"press",value:function(t){return this.post(t,null,"moder/press")}}]),e}(),ApiUser=function(t){function i(){_classCallCheck(this,i);return _possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"/","1234",null,null))}return _inherits(i,Api),_createClass(i,[{key:"regnow",value:function(t){return this.save({token:t},null,"user/regnow")}},{key:"saveSex",value:function(t,e){return this.save({sex:t,token:e},null,"option/sex")}},{key:"saveAge",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{age:t},null,"option/age")}},{key:"saveName",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{name:t},null,"option/name")}},{key:"saveCity",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{city:t},null,"option/city")}},{key:"saveContacts",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{contact:t},null,"option/contact")}},{key:"saveSearch",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,t,null,"msett/save")}},{key:"syncAbout",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"load",this).call(this,null,"sync/anketa")}},{key:"saveAbout",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,t,null,"option/anketa")}},{key:"syncAuth",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"load",this).call(this,null,"sync/authdata")}},{key:"saveLogin",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{login:t},null,"option/login")}},{key:"savePasswd",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{pass:t},null,"option/passwd")}},{key:"saveEmail",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{email:t},null,"option/email")}},{key:"removeEmail",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"remove",this).call(this,null,null,"option/demail")}},{key:"saveSubscribe",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,null,null,"option/subscr")}},{key:"desireList",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"load",this).call(this,null,"tag/user")}},{key:"desireAdd",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"save",this).call(this,{tag:t},null,"tag/add")}},{key:"desireDelete",value:function(t){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"remove",this).call(this,{id:t},null,"tag/del")}},{key:"visitedList",value:function(){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"load",this).call(this,null,"contact/visited")}},{key:"visitedAdd",value:function(t,e){return _get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"send",this).call(this,{tid:e,uid:t},"contact/addvisit/{uid}")}}]),i}(),ApiSearch=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"http://search.a4sex.net/","1234",null,{route:"users",get:"{tid}"}))}return _inherits(e,Api),e}(),ApiContact=function(t){function i(t){_classCallCheck(this,i);var e=store.state.apiToken;return _possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"http://contact.a4sex.net/",e,null,t))}return _inherits(i,Api),_createClass(i,[{key:"refresh",value:function(){store.dispatch("LOAD_API_TOKEN"),this.setAuthKey(store.state.apiToken)}}]),i}(),ApiInitial=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{route:"users/{uid}/initials"}))}return _inherits(e,ApiContact),e}(),ApiIntimate=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{route:"users/{uid}/intimates"}))}return _inherits(e,ApiContact),e}(),ApiSends=function(t){function e(){_classCallCheck(this,e);return _possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{route:"users/{uid}/sends"}))}return _inherits(e,ApiContact),e}(),api={user:new ApiUser,search:new ApiSearch,bun:new ApiBun,contacts:{initial:new ApiInitial,intimate:new ApiIntimate,sends:new ApiSends},messages:new ApiMessages,moderator:new ApiModerator,raw:new Api},routes=[{path:"/write/:humanId(\\d+)/(.*)?",name:"quickWrite",component:QuickMessage,props:!0,beforeEnter:function(t,e,i){return store.state.user.sex?i():i("/confirm-sex/message")}},{path:"/initial/(.*)?",name:"initial",component:InitialDialog,props:{reply:!0},children:[{path:":humanId(\\d+)/(.*)?",name:"quickReply",meta:{back:"/initial"},component:QuickReply,props:!0}]},{path:"/intimate/(.*)?",name:"intimate",component:IntimateDialog,props:!0,children:[{path:":humanId(\\d+)/(.*)?",name:"dialog",meta:{back:"/intimate"},component:MessagesActivity,props:!0,children:[{path:"uploads",name:"uploads",meta:{back:"."},component:PhotoSettings,props:!0},{path:"incoming",name:"incoming",meta:{back:"."},component:IncomingPhoto,props:!0}]}]},{path:"/confirm-sex/:show?",component:SexConfirm,props:!0},{path:"/protect",component:ModeratorActivity},{path:"/content/deal/:link/:locale?",component:DealContentPage,props:!0},{path:"/content/rules/:locale?",component:RulesContentPage,props:!0},{path:"/content/careers/:locale?",component:СareersContentPage,props:!0},{path:"/help/:link/:locale?",component:HelpContentPage,props:!0},{path:"/releases/:link/:locale?",component:ReleaseContentPage,props:!0},{path:"(.*)?/settings/search",meta:{back:"/"},component:SearchSettings,beforeEnter:function(t,e,i){return store.state.user.sex?i():i("/confirm-sex/search")}},{path:"(.*)?/settings/account",component:AccountSettings,beforeEnter:function(t,e,i){return store.state.user.sex?i():i("/confirm-sex/account")}},{path:"(.*)?/settings/other",component:OtherSettings},{path:"(.*)?/settings/about",meta:{back:"other"},component:AboutSettings},{path:"(.*)?/settings/social",meta:{back:"other"},component:SocialSettings},{path:"(.*)?/settings/desires",meta:{back:"other"},component:DesiresSettings,beforeEnter:function(t,e,i){return store.state.user.sex?i():i("/confirm-sex/search")}},{path:"(.*)?/settings/security",meta:{back:"other"},component:SecuritySettings},{path:"(.*)?/settings/reviews",meta:{back:"other"},component:ReviewSettings},{path:"(.*)?/settings/question",meta:{back:"other"},component:QuestionActivity},{path:"(.*)?/settings/envelop",meta:{back:"other"},component:EnvelopSettings},{path:"(.*)?/wizard/city",meta:{back:"/settings/account"},component:CityWizard,beforeEnter:function(t,e,i){return store.state.user.sex?i():i("/confirm-sex/city")}}],router=new VueRouter({routes:routes}),settingsRouter=new VueRouter({routes:[{path:"/search/settings/account",meta:{back:"search"},component:AccountSettings},{path:"(.*)?/:humanId(\\d+)/detail",component:AccountActivity,props:!0},{path:"(.*)?/notepad",component:Notepad,props:!0},{path:"/login",name:"login",component:LoginAccount}]});settingsRouter.beforeEach(function(t,e,i){t.meta.back||(t.meta.back=e.fullPath),i()});var hash,app=new Vue({data:{alert:"",humanId:null,snackbar:{text:"",callback:null,action:""}},mounted:function(){this.$store.dispatch("notes/LOAD");var t=parseInt(window.location.pathname.split("/")[1]);this.humanId=t||null,this.humanId&&this.$store.dispatch("search/HUMAN",this.humanId)},computed:{simple:function(){return this.$store.state.simple},ready:function(){return this.$store.state.ready},promt:function(){var t=this.$store.state.user.promt;return!t||"no"==t},tags:function(){return this.$store.getters["search/tags"]},human:function(){return this.$store.state.search.human}},methods:{showSnackbar:function(t,e,i,n){console.log("snackbar",t),this.snackbar.text=t,this.snackbar.callback=e,this.snackbar.action=i,this.snackbar.play=1==n},toast:function(t){this.alert=t},reload:function(){var t=this.$refs.results;t?t.reload():this.redirectHome()},redirectHome:function(){console.log("Hard reload mail page to home"),window.location="/"}},el:"#app",store:store,router:router});function simple_hash(){var t=new Date;hash=t.getTime()}new Vue({data:{warning:"",alert:""},methods:{snackbar:function(t){this.warning=t},toast:function(t){this.alert=t}},el:"#settings",store:store,router:settingsRouter}),$(document).ready(function(){navigate.init()});var navigate={enable:0,init:function(){$(document).on("keydown",function(){navigate.through(event)})},post_form:function(t,e){!t.ctrlKey||10!=t.keyCode&&13!=t.keyCode||e.submit()},through:function(t){if(window.event&&(t=window.event),t.ctrlKey){var e=null;switch(t.keyCode?t.keyCode:t.which?t.which:null){case 37:e="#previous_page";break;case 39:e="#next_page";break;case 38:e="#up_page";break;case 40:e="#down_page";break;case 36:e="#home_page"}$("a").is(e)&&(document.location=$(e).attr("href"))}}};